"0","# Chart 3 — Horizontal Bar (Many items, Few categories)"
"0",""
"0","df3 <- df %>%"
"0","  group_by(Continent) %>%"
"0","  slice_max(order_by = Cases, n = 8, with_ties = FALSE) %>%"
"0","  ungroup() %>%"
"0","  mutate("
"0","    y_comb = paste(Continent, Country, sep = "" | "")"
"0","  ) %>%"
"0","  group_by(Continent) %>%"
"0","  arrange(Cases, .by_group = TRUE) %>%"
"0","  mutate("
"0","    # 在各洲内部设置因子顺序（从小到大，条形从下到上）"
"0","    y_comb = factor(y_comb, levels = unique(y_comb))"
"0","  ) %>%"
"0","  ungroup()"
"0",""
"0","# 只显示国家名的 labeller"
"0","only_country <- function(x) sub(""^.*\\|\\s*"", """", x)"
"0",""
"0","p3 <- ggplot(df3, aes(x = Cases, y = y_comb)) +"
"0","  geom_col(fill = ""#74c476"") +"
"0","  facet_wrap(~ Continent, nrow = 1, scales = ""free_y"") +"
"0","  scale_y_discrete(labels = only_country) +"
"0","  scale_x_continuous(labels = label_comma()) +"
"0","  labs("
"0","    title = ""Chart 3 — Horizontal Bar Chart (Many Items, Few Categories)"","
"0","    subtitle = ""Top 8 countries by total cases within each continent (latest per country)"","
"0","    x = ""Total Cases"", y = ""Country"""
"0","  ) +"
"0","  theme_minimal(base_size = 13) +"
"0","  theme(plot.title = element_text(face = ""bold""))"
"0","print(p3)"
