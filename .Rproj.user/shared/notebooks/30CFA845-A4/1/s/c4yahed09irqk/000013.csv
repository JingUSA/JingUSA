"0",""
"0","# Chart 2 — Table with Embedded Charts"
"0",""
"0","top6_tbl <- df %>%"
"0","  slice_max(order_by = Cases, n = 6, with_ties = FALSE) %>%"
"0","  select(Country, Population, GDP)"
"0",""
"0","long2 <- top6_tbl %>%"
"0","  pivot_longer(c(Population, GDP), names_to = ""Metric"", values_to = ""Value"") %>%"
"0","  group_by(Metric) %>%"
"0","  mutate(Value_scaled = Value / max(Value, na.rm = TRUE)) %>%"
"0","  ungroup()"
"0",""
"0","p2 <- ggplot(long2, aes(x = 1, y = Value_scaled)) +"
"0","  geom_col(width = 0.6, fill = ""#6baed6"") +"
"0","  facet_grid(rows = vars(Country), cols = vars(Metric), switch = ""y"") +"
"0","  coord_cartesian(ylim = c(0,1)) +"
"0","  labs("
"0","    title=""Chart 2 — Table with Embedded Charts (ggplot-only)"","
"0","    subtitle=""Rows = Top-6 by Cases; Columns = Population (M) & GDP per capita (scaled within column)"","
"0","    x=NULL, y=NULL"
"0","  ) +"
"0","  theme_minimal(base_size=13) +"
"0","  theme("
"0","    axis.text=element_blank(), axis.ticks=element_blank(), panel.grid=element_blank(),"
"0","    strip.placement=""outside"","
"0","    strip.background=element_rect(fill=""grey95"", color=NA),"
"0","    panel.border=element_rect(color=""grey70"", fill=NA, linewidth=0.5),"
"0","    plot.title=element_text(face=""bold""),"
"0","    plot.margin=margin(10,10,10,16)"
"0","  )"
"0","print(p2)"
