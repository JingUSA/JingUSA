"0","library(readxl)"
"0",""
"0","hpi_path <- ""/Users/jingtao/Desktop/FALL 2025/DATA VISUALIZATION/Assignment 2/HPI_2024_public_dataset.xlsx"""
"0",""
"0","df <- tryCatch("
"0","read_excel(hpi_path, sheet = ""All Data"",        skip = 1),"
"0","error = function(e) read_excel(hpi_path, sheet = ""1. All countries"", skip = 8)"
"0",")"
"0",""
"0","# figure out column names for 2 possible sheet layouts"
"0",""
"0","if (""LifeExp"" %in% names(df)) {"
"0","life_col    <- ""LifeExp""                  # All Data"
"0","hpi_col     <- ""HPI"""
"0","country_col <- ""Country"""
"0","region_col  <- ""Continent"""
"0","} else {"
"0","life_col    <- ""Life Expectancy (years)""  # 1. All countries"
"0","hpi_col     <- ""HPI"""
"0","country_col <- ""Country"""
"0","region_col  <- ""Continent"""
"0","}"
"0",""
"0","ok    <- complete.cases(df[[life_col]], df[[hpi_col]])"
"0","x_le  <- as.numeric(df[[life_col]][ok])   # life expectancy"
"0","y_hpi <- as.numeric(df[[hpi_col]][ok])    # HPI score"
"0","cty   <- df[[country_col]][ok]"
"0","reg   <- df[[region_col]][ok]"
"0",""
"0","length(x_le); length(y_hpi)"
"1","[1]"
"1"," 2135"
"1","
"
"1","[1]"
"1"," 2135"
"1","
"
"0","head("
"0","data.frame("
"0","country = cty,"
"0","lifeexp = x_le,"
"0","hpi     = y_hpi"
"0","),"
"0","6"
"0",")"
